#!/usr/bin/bash

set -eoux pipefail

coprs=(
  ublue-os/staging
  ublue-os/packages
  bazzite-org/bazzite
  bazzite-org/bazzite-multilib
  ycollet/audinux
  bazzite-org/webapp-manager
  che/nerd-fonts
)

if [[ "${1:-enable}" == "enable" ]]; then
  IFS=$'\n\t' for copr in "${coprs[@]}"; do
    dnf5 -y copr enable "$copr"
    dnf5 -y config-manager setopt copr:copr.fedorainfracloud.org:"${copr////:}".priority=98
  done

  sed -i 's@priority=98@priority=1@g' /etc/yum.repos.d/_copr:copr.fedorainfracloud.org:ycollet:audinux.repo
else
  IFS=$'\n\t' for copr in "${coprs[@]}"; do
    dnf5 -y copr disable "$copr"
  done
fi
